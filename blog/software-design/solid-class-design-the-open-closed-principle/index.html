<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SOLID Class Design: The Open Closed Principle — Tom Dalling</title>
    <link rel="stylesheet" href="/style.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:wght@700&amp;family=Merriweather:ital,wght@0,400;0,700;1,400;1,700&amp;family=Montserrat:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">

    <meta name="twitter:site" content="@tom_dalling">
    <meta name="twitter:creator" content="@tom_dalling">
    <link rel="alternate" type="application/rss+xml" title="Tom Dalling" href="https://www.tomdalling.com/blog/feed/">
  <link rel="canonical" href="https://www.tomdalling.com/blog/software-design/solid-class-design-the-open-closed-principle/">
<meta property="og:title" content="SOLID Class Design: The Open Closed Principle">
<meta property="og:url" content="https://www.tomdalling.com/blog/software-design/solid-class-design-the-open-closed-principle/">
<meta property="og:image" content="https://www.tomdalling.com/images/posts/ocp.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

  <body>

    <header class="tw-mb-6 tw-py-2 tw-bg-gray-100 tw-border-b tw-border-gray-200 tw-font-title">
      <nav class="tw-container tw-mx-auto max-w-screen-xl tw-space-x-8 tw-px-4">
        <a href="/" class="tw-text-xl tw-text-black">Tom Dalling</a>
        <a href="/blog/" class="tw-text-black">Blog</a>
      </nav>
    </header>

    <div class="tw-container tw-mx-auto tw-flex tw-flex-col lg:tw-flex-row">

      <main class="tw-flex-1 tw-min-w-0 tw-px-4"><article class="post post-single">

  <header>
    <h1><a href="/blog/software-design/solid-class-design-the-open-closed-principle/">SOLID Class Design: The Open Closed Principle</a></h1>
    <small class="meta">
      <span class="post-date">14 Nov, 2009</span>
      
      —
      Category: <a class="category" href="/blog/category/software-design/">Software Design</a>
      —
      Suggest changes <a class="post-github" href="https://github.com/tomdalling/tomdalling.com/tree/main/input/posts/2009-11-14_solid-class-design-the-open-closed-principle.markdown">on GitHub</a>
    </small>
    <div class="main-image">
      <img src="/images/posts/ocp.jpg" class="img-responsive">
      <span class="credit">Image courtesy of <a class="artist" href="http://www.lostechies.com/blogs/derickbailey/archive/2009/02/11/solid-development-principles-in-motivational-pictures.aspx">Derick Bailey</a>.</span>
    </div>
  </header>

  <div class="post-content body-text">
<p>This is part two of a five part series about <a href="http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod" title="Principles of OOD">SOLID class design principles</a>
by <a href="http://www.objectmentor.com/omTeam/martin_r.html">Robert C. Martin</a>. The SOLID principles focus on achieving code that is
maintainable, robust, and reusable. In this post, I will discuss the Open
Closed Principle.</p>

<blockquote>
  <p><strong>The Open Closed Principle (OCP)</strong>: <em>You should be able to extend a classes behavior, without modifying it</em>.</p>
</blockquote>

<!--more-->

<p>The OCP is sometimes alternatively defined as:</p>

<blockquote>
  <p><em>A class should be open to extension, but closed to modification.</em></p>
</blockquote>

<p>Robert Martin sums up the rationale for the OCP like this:</p>

<blockquote>
  <p>“When a single change to a program results in a cascade of changes to dependent
modules, that program exhibits the undesirable attributes that we have come to
associate with ‘bad’ design. The program becomes fragile, rigid, unpredictable
and unreusable. The open-closed principle attacks this in a very
straightforward way. It says that you should design modules that never change.
When requirements change, you extend the behavior of such modules by adding new
code, not by changing old code that already works.” — Robert Martin</p>
</blockquote>

<p>At first, the OCP can sound contradictory. How can you change the behavior of a
class without modifying it? In a nutshell, the answer is the cornerstone of
object oriented design: <a href="http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming">polymorphism</a>.  The example later in the article
will show how polymorphism is used to achieve classes that are “closed” to
changes.</p>

<h2>The Benefits</h2>

<p>As stated by Robert Martin, classes that must be modified to accommodate new
changes are fragile, rigid, unpredictable and unreusable. By insulating the
class from changes, the class becomes robust, flexible, and reusable. Also as
no modifications are made to the code no bugs can be introduced, leading to
code that only becomes more stable over time through testing. The ability to
reuse a class that has been working for years without modification is clearly
preferable to modifying the class every time requirements change.</p>

<h2>An Example</h2>

<p>Continuing on from the example in the previous post about <a href="http://tomdalling.com/software-design/solid-class-design-the-single-responsibility-principle">the Single
Responsibility Principle</a>, I’m going to modify the code to allow for multiple
export file formats.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/********* XMLConverter ************/</span>
<span class="k">class</span> <span class="nc">XMLConverter</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">String</span> <span class="n">convertDocumentToXML</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="c1">// ... (code ommitted)</span>

<span class="cm">/********* BinaryConverter *********/</span>
<span class="k">class</span> <span class="nc">BinaryConverter</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">Data</span> <span class="n">convertDocumentToBinary</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ... (code ommitted)</span>
 
<span class="cm">/********* DocumentExporter ************/</span>

<span class="k">enum</span> <span class="n">ConverterType</span> <span class="p">{</span>
    <span class="n">XMLConverterType</span><span class="p">,</span>
    <span class="n">BinaryConverterType</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">DocumentExporter</span> <span class="p">{</span>
<span class="nl">private:</span>
    <span class="n">URL</span> <span class="n">_runSaveDialog</span><span class="p">();</span>
    <span class="kt">void</span> <span class="n">_showSuccessDialog</span><span class="p">;</span>
    <span class="n">ConverterType</span> <span class="n">_converterType</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">setConverterType</span><span class="p">(</span><span class="n">ConverterType</span> <span class="n">converterType</span><span class="p">);</span>
    <span class="kt">void</span> <span class="n">exportDocument</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">};</span>
 
<span class="kt">void</span> <span class="n">DocumentExporter</span><span class="o">::</span><span class="n">exportDocument</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">URL</span> <span class="n">fileURL</span> <span class="o">=</span> <span class="n">_runSaveDialog</span><span class="p">();</span>
    
    <span class="k">switch</span><span class="p">(</span><span class="n">_converterType</span><span class="p">){</span>
        <span class="k">case</span> <span class="n">XMLConverterType</span><span class="p">:{</span>
            <span class="n">XMLConverter</span> <span class="n">xmlConverter</span><span class="p">;</span>
            <span class="n">String</span> <span class="n">xmlFileContent</span> <span class="o">=</span> <span class="n">xmlConverter</span><span class="p">.</span><span class="n">convertDocumentToXML</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
            <span class="n">xmlFileContent</span><span class="p">.</span><span class="n">writeToURL</span><span class="p">(</span><span class="n">fileURL</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
            
        <span class="k">case</span> <span class="n">BinaryConverterType</span><span class="p">:{</span>
            <span class="n">BinaryConverter</span> <span class="n">binaryConverter</span><span class="p">;</span>
            <span class="n">Data</span> <span class="n">binaryFileContent</span> <span class="o">=</span> <span class="n">binaryConverter</span><span class="p">.</span><span class="n">convertDocumentToBinary</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
            <span class="n">binaryFileContent</span><span class="p">.</span><span class="n">writeToURL</span><span class="p">(</span><span class="n">fileURL</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="nl">default:</span>
            <span class="n">LogError</span><span class="p">(</span><span class="s">"Unrecognised converter type"</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">_showSuccessDialog</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// ... (code ommitted)</span>

</code></pre></div></div>

<p>The <code>DocumentExporter</code> class is <strong>not</strong> closed to change. Every time a new
export format must be supported, the <code>DocumentExporter</code> class must be modified.
<strong>Enums and switch statements are strong indicators that a class is not closed
to changes</strong>. If the enum changes, then every related switch statement must
also be changed.</p>

<p>The way to close <code>DocumentExporter</code> to changes, in this case, is to make an
abstract base class for all the converters. Then, the converter can be supplied
to <code>DocumentExporter</code> via a technique called <a href="http://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a>. The
solution is as follows:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/********* Converter ************/</span>

<span class="k">class</span> <span class="nc">Converter</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">virtual</span> <span class="n">Data</span> <span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/********* XMLConverter ************/</span>

<span class="k">class</span> <span class="nc">XMLConverter</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Converter</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">Data</span> <span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">};</span>

<span class="n">Data</span> <span class="n">XMLConverter</span><span class="o">::</span><span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//convert to xml here</span>
<span class="p">}</span>

<span class="cm">/********* BinaryConverter ************/</span>

<span class="k">class</span> <span class="nc">BinaryConverter</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Converter</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">Data</span> <span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">};</span>

<span class="n">Data</span> <span class="n">BinaryConverter</span><span class="o">::</span><span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//convert to binary here</span>
<span class="p">}</span>
 
<span class="cm">/********* DocumentExporter ************/</span>

<span class="k">class</span> <span class="nc">DocumentExporter</span> <span class="p">{</span>
<span class="nl">private:</span>
    <span class="n">URL</span> <span class="n">_runSaveDialog</span><span class="p">();</span>
    <span class="kt">void</span> <span class="n">_showSuccessDialog</span><span class="p">;</span>
    <span class="n">Converter</span><span class="o">*</span> <span class="n">_converter</span><span class="p">;</span>
<span class="nl">public:</span>
    <span class="kt">void</span> <span class="n">setConverter</span><span class="p">(</span><span class="n">Converter</span><span class="o">*</span> <span class="n">converter</span><span class="p">);</span> <span class="c1">//Here is the dependency injection function</span>
    <span class="kt">void</span> <span class="n">exportDocument</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">);</span>
<span class="p">};</span>
 
<span class="kt">void</span> <span class="n">DocumentExporter</span><span class="o">::</span><span class="n">exportDocument</span><span class="p">(</span><span class="n">Document</span> <span class="n">doc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">URL</span> <span class="n">fileURL</span> <span class="o">=</span> <span class="n">_runSaveDialog</span><span class="p">();</span>
    <span class="n">Data</span> <span class="n">fileContent</span> <span class="o">=</span> <span class="n">_converter</span><span class="p">.</span><span class="n">convertDocumentToData</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
    <span class="n">fileContent</span><span class="p">.</span><span class="n">writeToURL</span><span class="p">(</span><span class="n">fileURL</span><span class="p">);</span>
    <span class="n">_showSuccessDialog</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// ... (code ommitted)</span>

</code></pre></div></div>

<p>In the above example, <code>DocumentExporter</code> is closed to change in respect to new
export formats. To support a new export format, a new class is created that
inherits from <code>Converter</code>. The new converter is injected into <code>DocumentExporter</code>
via the <code>setConverter</code> method, and <strong><code>DocumentExporter</code> is not modified in any
way</strong>.</p>

<p>Note that a class can never be <em>completely</em> closed. There will always be
unforeseen changes that require a class to be modified. However, if changes can
be foreseen, such as different export formats, then you have a perfect
opportunity to apply the OCP to make your life easier when those change
requests come rolling in.</p>

</div>

  <footer>
    <div class="tw-rounded-3xl tw-bg-pink-100 tw-p-8 tw-my-16 tw-text-center tw-bg-opacity-50">
      <p class="tw-text-2xl tw-uppercase tw-text-pink-900 tw-font-black tw-mb-4">Enjoy this?</p>

      <p class="tw-flex tw-flex-col sm:tw-flex-row tw-justify-center tw-item-center sm:tw-items-baseline">
        <a href="/feed/" class="tw-flex-1 tw-bg-pink-500 tw-py-3 tw-px-4 tw-rounded-lg tw-text-pink-100 tw-ring-2 tw-ring-pink-300 hover:tw-text-white">Subscribe via RSS</a>
        <span class="tw-flex-none tw-px-8 tw-py-4 tw-text-pink-800">or</span>
        <a href="https://twitter.com/tom_dalling" class="tw-flex-1 tw-bg-pink-500 tw-py-3 tw-px-4 tw-rounded-lg tw-text-pink-100 tw-ring-2 tw-ring-pink-300 hover:tw-text-white">Follow on Twitter</a>
      </p>

      <p class="tw-text-center tw-mt-4 tw-mb-0 tw-text-pink-900">
        <em>Found a mistake?</em> Pull requests are welcome on
        <a href="https://github.com/tomdalling/tomdalling.com/whatever">GitHub</a>.
      </p>
</div>

    


    
      <h2>Comments</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript" id="disqus_script">
        var disqus_shortname = "tomdalling";
        var disqus_identifier = "245 http://tomdalling.com/?p=245";
        var disqus_title = "SOLID Class Design: The Open Closed Principle";
        var disqus_url = "https://www.tomdalling.com/blog/software-design/solid-class-design-the-open-closed-principle/";

        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a>
</noscript>
    

  </footer>
</article>
</main>

      <aside class="tw-px-4 tw-text-center lg:tw-text-left lg:tw-w-1/3 tw-flex-none">

        <div class="tw-text-lg tw-font-title tw-mb-1">Subscribe</div>
        <ul class="tw-space-y-2">
          <li>
            <a href="/blog/feed/">
              <i class="fa fa-rss"></i> RSS
            </a>
          </li>
          <li>
            <a href="https://twitter.com/tom_dalling">
              <i class="fa fa-twitter"></i> Twitter
            </a>
          </li>
        </ul>

        <div class="tw-text-lg tw-font-title tw-mb-1 tw-mt-6">Recent Posts</div>
        <ul class="recent-posts tw-space-y-2">
          
        <li><a href="/blog/software-design/thoughts-on-schema-library-design/">Thoughts On Schema Library Design</a></li>
<li><a href="/blog/software-processes/github-workflow-for-automated-gem-releases/">GitHub Workflow For Automated Gem Releases</a></li>
<li><a href="/blog/testing/monologue-on-end-to-end-testing/">Monologue On End-To-End Testing</a></li>
<li><a href="/blog/mentoring/write-detailed-rspec-example-descriptions/">Write Detailed RSpec Example Descriptions</a></li>
<li><a href="/blog/mentoring/start-with-high-level-tests/">Start With High-Level Tests</a></li>
</ul>

        <div class="tw-text-lg tw-font-title tw-mb-1 tw-mt-6">Categories</div>
        <ul class="categories tw-space-y-2">
          
        <li>
            <a href="/blog/cocoa/" class="category">Cocoa</a>
            (<span class="post-count">5</span>
            <a class="feed" href="/blog/cocoa/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/coding-styleconventions/" class="category">Coding Style/Conventions</a>
            (<span class="post-count">3</span>
            <a class="feed" href="/blog/coding-styleconventions/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/coding-tips/" class="category">Coding Tips</a>
            (<span class="post-count">4</span>
            <a class="feed" href="/blog/coding-tips/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/mentoring/" class="category">Mentoring Notes</a>
            (<span class="post-count">2</span>
            <a class="feed" href="/blog/mentoring/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/random-stuff/" class="category">Miscellaneous</a>
            (<span class="post-count">3</span>
            <a class="feed" href="/blog/random-stuff/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/modern-opengl/" class="category">Modern OpenGL Series</a>
            (<span class="post-count">10</span>
            <a class="feed" href="/blog/modern-opengl/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/ruby/" class="category">Ruby</a>
            (<span class="post-count">2</span>
            <a class="feed" href="/blog/ruby/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/software-design/" class="category">Software Design</a>
            (<span class="post-count">12</span>
            <a class="feed" href="/blog/software-design/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/software-processes/" class="category">Software Processes</a>
            (<span class="post-count">3</span>
            <a class="feed" href="/blog/software-processes/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/testing/" class="category">Testing</a>
            (<span class="post-count">2</span>
            <a class="feed" href="/blog/testing/feed/"><i class="fa fa-rss"></i></a>)
          </li>
<li>
            <a href="/blog/web/" class="category">Web</a>
            (<span class="post-count">1</span>
            <a class="feed" href="/blog/web/feed/"><i class="fa fa-rss"></i></a>)
          </li>
</ul>

        <div class="tw-text-lg tw-font-title tw-mb-1 tw-mt-6">Archives</div>
        <ul class="archives tw-space-y-2">
          
        <li>
            <a href="/blog/2021/" class="year">2021</a>
            (<span class="post-count">6</span>)
          </li>
<li>
            <a href="/blog/2020/" class="year">2020</a>
            (<span class="post-count">5</span>)
          </li>
<li>
            <a href="/blog/2016/" class="year">2016</a>
            (<span class="post-count">1</span>)
          </li>
<li>
            <a href="/blog/2015/" class="year">2015</a>
            (<span class="post-count">2</span>)
          </li>
<li>
            <a href="/blog/2014/" class="year">2014</a>
            (<span class="post-count">3</span>)
          </li>
<li>
            <a href="/blog/2013/" class="year">2013</a>
            (<span class="post-count">5</span>)
          </li>
<li>
            <a href="/blog/2012/" class="year">2012</a>
            (<span class="post-count">10</span>)
          </li>
<li>
            <a href="/blog/2011/" class="year">2011</a>
            (<span class="post-count">1</span>)
          </li>
<li>
            <a href="/blog/2010/" class="year">2010</a>
            (<span class="post-count">5</span>)
          </li>
<li>
            <a href="/blog/2009/" class="year">2009</a>
            (<span class="post-count">9</span>)
          </li>
</ul>

      </aside>

    </div>

    <footer class="page-footer">
      <p>© 2009 – <span class="current-year">2021</span> Tom Dalling</p>

      <p class="social">
        <a href="https://twitter.com/tom_dalling">
          <i class="fa fa-lg fa-twitter"></i>
        </a>
        <a href="https://github.com/tomdalling">
          <i class="fa fa-lg fa-github"></i>
        </a>
        <a href="https://stackoverflow.com/users/108105/tom-dalling">
          <i class="fa fa-lg fa-stack-overflow"></i>
        </a>
        <a href="mailto:tom%20at%20tomdalling%20com">
          <i class="fa fa-lg fa-envelope"></i>
        </a>
      </p>
    </footer>

    <script src="/bundles/all.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$$','$$']],
          displayMath: [['[blockmath]', '[/blockmath]']]
        }
      });
    </script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  </body>
</html>
